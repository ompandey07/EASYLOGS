<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EASY LOGS CHEQUES</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <!-- Add SheetJS library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
      @keyframes glow {
        0% {
          filter: drop-shadow(0 0 2px currentColor);
        }
        50% {
          filter: drop-shadow(0 0 5px currentColor);
        }
        100% {
          filter: drop-shadow(0 0 2px currentColor);
        }
      }
      .glow-icon {
        animation: glow 2s infinite;
      }
    </style>
  </head>
  <body class="bg-gray-100 min-h-screen flex flex-col">
    <nav class="sticky top-0 bg-white shadow-md z-10">
      <div class="w-full px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <img
            src="https://1000logos.net/wp-content/uploads/2021/06/Easy-Logo-2003.png"
            alt="Logo"
            class="h-8 w-auto"
          />
          <div class="relative">
            <select
              id="AmountFilter"
              class="bg-gray-100 rounded-full py-2 px-4 pr-8 focus:outline-none appearance-none"
            >
              <option value="all">Amount Wise</option>
              <option value="50 Hajar">50 Hajar</option>
              <option value="1 Lakh">1 Lakh</option>
              <option value="1 Lakh Above">1 Lakh Above</option>
            </select>
            <i
              class="ri-wallet-2-fill absolute right-3 top-2 text-gray-400"
            ></i>
          </div>
          <div class="flex items-center space-x-4">
            <div class="relative">
              <select
                id="handlerFilter"
                class="bg-gray-100 rounded-full py-2 px-4 pr-8 focus:outline-none appearance-none"
              >
                <option value="all">All Handlers</option>
                <!-- Options will be dynamically populated -->
              </select>
              <i class="ri-user-line absolute right-3 top-2 text-gray-400"></i>
            </div>
          </div>
          <button
            id="exportButton"
            class="bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded flex items-center"
          >
            <i class="ri-file-excel-2-line mr-2"></i> Export to Excel
          </button>
          <div class="relative">
            <input
              type="text"
              id="searchInput"
              placeholder="Search..."
              class="bg-gray-100 rounded-full py-2 px-4 pr-10 focus:outline-none"
            />
            <i class="ri-search-line absolute right-3 top-2 text-gray-400"></i>
          </div>
        </div>
      </div>
    </nav>

    <div class="w-full overflow-x-auto flex-grow">
      <table id="dataTable" class="w-full bg-white border border-gray-200">
        <thead class="text-gray-700">
          <tr>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-list-ordered mr-2 glow-icon text-red-500"></i>SN
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-user-line mr-2 glow-icon text-blue-500"></i>Handled
              By
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-building-line mr-2 glow-icon text-green-500"></i
              >Company Name
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-bank-line mr-2 glow-icon text-yellow-500"></i>Bank
              Name
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-bank-card-line mr-2 glow-icon text-pink-500"></i
              >Cheque Number
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-wallet-3-line mr-2 glow-icon text-indigo-500"></i
              >Cheque Amount
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-calendar-line mr-2 glow-icon text-orange-500"></i
              >Cheque Date
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-calendar-line mr-2 glow-icon text-teal-500"></i>Miti
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-mail-line mr-2 glow-icon text-cyan-500"></i>Reminder
              Email
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-mail-add-line mr-2 glow-icon text-lime-500"></i>Extra
              Reminder Email
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider border whitespace-nowrap"
            >
              <i class="ri-chat-1-line mr-2 glow-icon text-purple-500"></i
              >Remarks
            </th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <!-- Sample rows, you can dynamically populate this with actual data -->
          <tr>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              1
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              Nisha Bhujel
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              Sample Company A
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              Bank of Example
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              CH12345
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              1000
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              2024-09-12
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              2081-04-01
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              user@example.com
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              extra@example.com
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              In progress
            </td>
          </tr>
          <tr>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              2
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              John Doe
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              Sample Company B
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              Global Bank
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              CH67890
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              3000
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              2024-09-15
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              2081-04-04
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              john@example.com
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              manager@example.com
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"
            >
              Completed
            </td>
          </tr>
          <!-- Add more rows as needed -->
        </tbody>
      </table>
    </div>

    <footer
      class="sticky bottom-0 bg-white shadow-md h-10 flex items-center justify-between px-4"
    >
      <div class="flex items-center">
        <img
          src="https://1000logos.net/wp-content/uploads/2021/06/Easy-Logo-2003.png"
          alt="Logo"
          class="h-6 w-auto mr-4"
        />
        <span class="text-sm font-semibold">Easy Company</span>
      </div>
      <div id="totalChequeAmount" class="text-sm font-semibold">
        Total Cheque Amount: Rs. 0
      </div>
      <div id="currentTime" class="text-sm">
        <i class="ri-time-line"></i> Time: 00:00:00
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const searchInput = document.getElementById("searchInput");
        const handlerFilter = document.getElementById("handlerFilter");
        const table = document.getElementById("dataTable");
        const rows = table.getElementsByTagName("tr");
        const exportButton = document.getElementById("exportButton");

        // Populate handler filter options
        const handlers = new Set();
        for (let i = 1; i < rows.length; i++) {
          const handler = rows[i].getElementsByTagName("td")[1].textContent;
          handlers.add(handler);
        }
        handlers.forEach((handler) => {
          const option = document.createElement("option");
          option.value = handler;
          option.textContent = handler;
          handlerFilter.appendChild(option);
        });

        function filterTable() {
          const searchText = searchInput.value.toLowerCase();
          const selectedHandler = handlerFilter.value;

          for (let i = 1; i < rows.length; i++) {
            const row = rows[i];
            const cells = row.getElementsByTagName("td");
            let found = false;

            for (let j = 0; j < cells.length; j++) {
              const cellText = cells[j].textContent.toLowerCase();
              if (cellText.indexOf(searchText) > -1) {
                found = true;
                break;
              }
            }

            const handlerCell = cells[1].textContent;
            const handlerMatch =
              selectedHandler === "all" || handlerCell === selectedHandler;

            row.style.display = found && handlerMatch ? "" : "none";
          }
        }

        // Excel export function
        function exportToExcel() {
          const wb = XLSX.utils.book_new();
          const ws = XLSX.utils.table_to_sheet(table);
          XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
          XLSX.writeFile(wb, "easy_logs_cheques.xlsx");
        }

        // Function to update total cheque amount
        function updateTotalChequeAmount() {
          const rows = document.querySelectorAll("#dataTable tbody tr");
          let total = 0;
          rows.forEach((row) => {
            const amountCell = row.querySelector("td:nth-child(6)");
            if (amountCell && row.style.display !== "none") {
              total += parseFloat(amountCell.textContent) || 0;
            }
          });
          document.getElementById(
            "totalChequeAmount"
          ).textContent = `Total Cheque Amount: Rs. ${total.toFixed(2)}`;
        }

        // Function to update current time
        function updateCurrentTime() {
          const now = new Date();
          const timeString = now.toLocaleTimeString();
          document.getElementById(
            "currentTime"
          ).innerHTML = `<i class="ri-time-line"></i> ${timeString}`;
        }

        // Update total and time initially and then every second
        updateTotalChequeAmount();
        updateCurrentTime();
        setInterval(updateCurrentTime, 1000);

        // Update total when table is filtered
        searchInput.addEventListener("keyup", () => {
          filterTable();
          updateTotalChequeAmount();
        });
        handlerFilter.addEventListener("change", () => {
          filterTable();
          updateTotalChequeAmount();
        });

        searchInput.addEventListener("keyup", filterTable);
        handlerFilter.addEventListener("change", filterTable);
        exportButton.addEventListener("click", exportToExcel);

        // Initial filter
        filterTable();
      });
    </script>
  </body>
</html>
